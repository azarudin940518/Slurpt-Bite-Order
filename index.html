<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>POS Slurp & Bite</title>
    <style>
        :root { --p: #2d5a27; --a: #d35400; --bg: #f8f9f8; --red: #e74c3c; }
        
        /* Menghalang skrol "bounce" pada iPhone */
        html, body { 
            position: fixed;
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg);
        }

        body { 
            display: flex; 
            flex-direction: column; 
            height: 100dvh; /* Dynamic Height khusus untuk iOS */
        }

        header { 
            background: var(--p); color: white; padding: 12px; text-align: center; 
            font-weight: bold; font-size: 16px; flex-shrink: 0;
            padding-top: env(safe-area-inset-top);
        }

        /* BAHAGIAN BINA SET */
        .builder { 
            background: #fff3e0; padding: 12px; border-bottom: 2px solid var(--a); 
            flex-shrink: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .set-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; }
        #set-list { font-weight: bold; font-size: 14px; color: #333; line-height: 1.3; flex: 1; padding-right: 10px; }
        .btn-reset { background: var(--red); color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 11px; font-weight: bold; }
        
        .input-group { display: flex; gap: 8px; margin-bottom: 5px; }
        .input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 10px; font-size: 16px; -webkit-appearance: none; background: white; }
        .btn-add { width: 100%; background: var(--a); color: white; border: none; padding: 14px; border-radius: 10px; font-weight: bold; font-size: 15px; }
        .btn-add:disabled { background: #ccc; }

        /* KAWASAN MENU (SKROL DISINI SAHAJA) */
        .menu-wrap { 
            flex: 1; 
            overflow-y: auto; 
            -webkit-overflow-scrolling: touch; 
            padding: 10px;
        }

        .cat-row { 
            display: flex; gap: 8px; overflow-x: auto; padding-bottom: 12px; 
            scrollbar-width: none; -webkit-overflow-scrolling: touch;
        }
        .cat-row::-webkit-scrollbar { display: none; }
        .c-btn { padding: 10px 18px; background: white; border: 1px solid #ddd; border-radius: 25px; white-space: nowrap; font-weight: bold; font-size: 13px; color: #555; }
        .c-btn.active { background: var(--p); color: white; border-color: var(--p); }

        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .card { background: white; padding: 10px; border-radius: 15px; border: 1px solid #eee; text-align: center; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
        .card:active { transform: scale(0.95); background: #f0f0f0; }
        .card img { width: 100%; height: 90px; object-fit: cover; border-radius: 10px; background: #eee; }
        .card h4 { font-size: 13px; margin: 8px 0 4px; height: 32px; overflow: hidden; display: flex; align-items: center; justify-content: center; color: #333; }
        .card p { font-weight: 800; color: var(--p); margin: 0; font-size: 15px; }

        /* FOOTER (STATIK DI BAWAH) */
        .footer { 
            background: white; border-top: 2px solid var(--p); 
            padding: 12px; flex-shrink: 0;
            padding-bottom: calc(12px + env(safe-area-inset-bottom));
        }
        .cart-preview { 
            max-height: 70px; overflow-y: auto; font-size: 12px; 
            color: #444; margin-bottom: 10px; background: #f9f9f9; padding: 8px; border-radius: 8px;
        }
        .cart-row-item { display: flex; justify-content: space-between; margin-bottom: 5px; border-bottom: 1px solid #eee; padding-bottom: 2px; }
        
        .calc-area { display: grid; grid-template-columns: 1.2fr 1fr 0.8fr; gap: 8px; margin-bottom: 10px; align-items: center; }
        .baki-box { font-size: 13px; font-weight: bold; color: var(--red); text-align: right; line-height: 1; }

        .row-final { display: flex; justify-content: space-between; align-items: center; }
        .total-text { font-size: 20px; font-weight: 900; color: var(--p); }
        .btn-pay { background: var(--p); color: white; border: none; padding: 14px 25px; border-radius: 12px; font-weight: bold; font-size: 16px; }
    </style>
</head>
<body>

<header>SLURP & BITE TAMAN ROSA</header>

<div class="builder">
    <div class="set-header">
        <div id="set-list">Pilih menu di bawah...</div>
        <button class="btn-reset" onclick="resetSet()">RESET</button>
    </div>
    <div class="input-group">
        <input type="text" id="remark" class="input" placeholder="Nota Set (cth: Tak nak pedas)">
    </div>
    <button class="btn-add" id="add-btn" onclick="simpanKeTroli()" disabled>+ MASUKKAN DALAM TROLI</button>
</div>

<div class="menu-wrap">
    <div class="cat-row">
        <button class="c-btn active" onclick="filterCat('Semua', this)">Semua</button>
        <button class="c-btn" onclick="filterCat('Makanan', this)">Makanan</button>
        <button class="c-btn" onclick="filterCat('Add On', this)">Add On</button>
        <button class="c-btn" onclick="filterCat('Minuman', this)">Minuman</button>
    </div>
    <div class="grid" id="menu-grid"></div>
</div>

<div class="footer">
    <div id="cart-preview" class="cart-preview">Troli Kosong</div>
    
    <div class="calc-area">
        <input type="text" id="cust-name" class="input" style="padding:8px" placeholder="Nama">
        <input type="number" id="cash-in" class="input" style="padding:8px" placeholder="Tunai RM" oninput="kiraBaki()">
        <div class="baki-box">Baki:<br>RM <span id="baki-total">0.00</span></div>
    </div>

    <div class="row-final">
        <div class="total-text">RM <span id="g-total">0.00</span></div>
        <button class="btn-pay" onclick="buatBayaran()">HANTAR WA</button>
    </div>
</div>

<script>
    const WA_NO = "60133002678";
    const items = [
        { c: 'Makanan', n: 'Oden Original', p: 0.00, i: 'https://i.postimg.cc/jCxvWrQT/oden.jpg' },
        { c: 'Makanan', n: 'Dry Pan Mee', p: 4.00, i: 'https://i.postimg.cc/Wt58gfXL/pan-mee.jpg' },
        { c: 'Makanan', n: 'Indo Mee', p: 3.00, i: 'https://i.postimg.cc/dkBBWWFr/indo-mee.jpg' },
        { c: 'Makanan', n: 'Mee Korean Cheese', p: 4.00, i: 'https://i.postimg.cc/5Q2mDwNJ/mee-sedap-cheese.jpg' },
        { c: 'Makanan', n: 'Mee Korean Spicy', p: 4.00, i: 'https://i.postimg.cc/RJZT2cV4/mee-sedap-spicy.jpg' },
        { c: 'Makanan', n: 'Nissin Korean', p: 5.00, i: 'https://i.postimg.cc/xqfgkSyS/nissin.jpg' },
        { c: 'Makanan', n: 'Wow Spageti', p: 3.00, i: 'https://i.postimg.cc/gnrDDqTQ/wow.jpg' },
        { c: 'Minuman', n: 'Chocolate Ice', p: 3.00, i: 'https://i.postimg.cc/bdyLGj0M/chocolate.png' },
        { c: 'Minuman', n: 'Green Tea Ice', p: 3.00, i: 'https://i.postimg.cc/Lh9vqMBF/green-tea.png' },
        { c: 'Minuman', n: 'Thai Tea Ice', p: 3.00, i: 'https://i.postimg.cc/pp7B15NX/thai-tea.png' },
        { c: 'Minuman', n: 'White Coffee', p: 5.00, i: 'https://i.postimg.cc/876b8kD1/white-coffee.png' },
        { c: 'Minuman', n: 'Aiskrim Float', p: 2.50, i: 'https://i.postimg.cc/f3Y5dzry/float.jpg' },
        { c: 'Minuman', n: 'Air Seringgit', p: 1.00, i: 'https://i.postimg.cc/t7BkWm24/singgit.jpg' },
        { c: 'Add On', n: 'Enoki', p: 1.00, i: 'https://i.postimg.cc/DW15GvMw/enoki.webp' },
        { c: 'Add On', n: 'Fucuk Ikan', p: 1.00, i: 'https://i.postimg.cc/S2qd7BBY/fucuk-ikan.jpg' },
        { c: 'Add On', n: 'Sosej', p: 1.00, i: 'https://i.postimg.cc/BtmpHwMJ/sosej.jpg' },
        { c: 'Add On', n: 'Telur', p: 1.00, i: 'https://i.postimg.cc/9zLbZNJD/telur.jpg' },
        { c: 'Add On', n: 'Ketam', p: 1.00, i: 'https://i.postimg.cc/YG33XX7Q/ketam.jpg' },
        { c: 'Add On', n: 'Sotong', p: 1.00, i: 'https://i.postimg.cc/yWLjcrv3/sotong.jpg' },
        { c: 'Add On', n: 'Salmon Ball', p: 1.00, i: 'https://i.postimg.cc/vD0hfS3s/salmon.jpg' },
        { c: 'Add On', n: 'Lobster Ball', p: 1.00, i: 'https://i.postimg.cc/vgzzPPyX/lobster.jpg' },
        { c: 'Add On', n: 'Maggi', p: 1.00, i: 'https://i.postimg.cc/gXDDMMpM/maggi.jpg' },
        { c: 'Add On', n: 'Ikan', p: 1.00, i: 'https://i.postimg.cc/LYRDBccJ/ikan.jpg' },
        { c: 'Add On', n: 'Udang', p: 1.00, i: 'https://i.postimg.cc/9rzpptn4/udang.jpg' },
        { c: 'Add On', n: 'Filament Stick', p: 1.00, i: 'https://i.postimg.cc/XZ9x5jzv/filament.jpg' }
    ];

    let currentSet = [];
    let cart = [];

    function renderMenu(filter = 'Semua') {
        const grid = document.getElementById('menu-grid');
        grid.innerHTML = '';
        items.filter(i => filter === 'Semua' || i.c === filter).forEach(item => {
            const card = document.createElement('div');
            card.className = 'card';
            card.onclick = () => {
                currentSet.push(item);
                updateSetDisplay();
            };
            card.innerHTML = `<img src="${item.i}" loading="lazy"><h4>${item.n}</h4><p>RM ${item.p.toFixed(2)}</p>`;
            grid.appendChild(card);
        });
    }

    function updateSetDisplay() {
        document.getElementById('set-list').innerText = currentSet.length ? currentSet.map(x => x.n).join(' + ') : 'Pilih menu di bawah...';
        document.getElementById('add-btn').disabled = currentSet.length === 0;
    }

    function resetSet() {
        currentSet = [];
        document.getElementById('remark').value = '';
        updateSetDisplay();
    }

    function filterCat(cat, btn) {
        document.querySelectorAll('.c-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderMenu(cat);
    }

    function simpanKeTroli() {
        const price = currentSet.reduce((a, b) => a + b.p, 0);
        cart.push({ desc: currentSet.map(x => x.n).join(' + '), note: document.getElementById('remark').value, price: price });
        resetSet();
        updateCartDisplay();
    }

    function updateCartDisplay() {
        const preview = document.getElementById('cart-preview');
        if (cart.length === 0) {
            preview.innerText = 'Troli Kosong';
        } else {
            preview.innerHTML = cart.map((c, i) => `
                <div class="cart-row-item">
                    <span>${i+1}. ${c.desc.substring(0,25)}.. (RM ${c.price.toFixed(2)})</span>
                    <span style="color:red; font-weight:bold;" onclick="padamCart(${i})"> PADAM </span>
                </div>`).join('');
        }
        const total = cart.reduce((a, b) => a + b.price, 0);
        document.getElementById('g-total').innerText = total.toFixed(2);
        kiraBaki();
    }

    function padamCart(idx) {
        cart.splice(idx, 1);
        updateCartDisplay();
    }

    function kiraBaki() {
        const total = parseFloat(document.getElementById('g-total').innerText);
        const tunai = parseFloat(document.getElementById('cash-in').value) || 0;
        const baki = tunai - total;
        document.getElementById('baki-total').innerText = baki > 0 ? baki.toFixed(2) : '0.00';
    }

    function buatBayaran() {
        const nama = document.getElementById('cust-name').value;
        if (!cart.length || !nama) return alert("Sila isi Nama & Troli!");

        let msg = `*SLURP & BITE TAMAN ROSA*\nPelanggan: ${nama}\n---\n`;
        cart.forEach((t, i) => {
            msg += `*Set ${i+1}:* ${t.desc}\n${t.note ? 'Nota: '+t.note+'\n' : ''}Harga: RM ${t.price.toFixed(2)}\n\n`;
        });
        const total = document.getElementById('g-total').innerText;
        const tunai = document.getElementById('cash-in').value || '0';
        const baki = document.getElementById('baki-total').innerText;
        msg += `---\n*TOTAL: RM ${total}*\nTUNAI: RM ${parseFloat(tunai).toFixed(2)}\nBAKI: RM ${baki}`;
        
        window.location.href = `https://wa.me/${WA_NO}?text=${encodeURIComponent(msg)}`;
    }

    window.onload = () => {
        renderMenu();
        // Menghalang zoom automatik pada iPhone bila klik input
        document.addEventListener('gesturestart', function (e) {
            e.preventDefault();
        });
    };
</script>
</body>
</html>
